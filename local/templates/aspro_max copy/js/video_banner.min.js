var players={};function pauseMainBanner(){$(".top_slider_wrapp .flexslider").flexslider("pause")}function playMainBanner(){$(".top_slider_wrapp .flexslider").flexslider("play")}function startMainBannerSlideVideo(e){var n=e.attr("data-slide_index"),a=e.closest(".slides").find('.box[data-slide_index="'+n+'"]');if(e.attr("data-video_source")){a.addClass("loading"),pauseMainBanner();var i=e.closest(".flexslider");i.addClass("video_visible");var r=i.data("slidesIndexesWithVideo");void 0===r&&(r=[]),r.push(n),i.data("slidesIndexesWithVideo",r);var l=e.attr("data-video_src"),d=1==e.attr("data-video_disable_sound"),s=1==e.attr("data-video_loop"),p=1==e.attr("data-video_cover"),y=(e.attr("data-video_under_text"),e.attr("data-video_player")),c="YOUTUBE"===y,v="VIMEO"===y,u="RUTUBE"===y,f="HTML5"===y,w=!f&&e.attr("data-video_width"),g=!f&&e.attr("data-video_height");if(l&&!e.find(".video").length){function t(){a.each(function(e,a){var i=$(a),r=getRandomInt(100,1e3),t=i.hasClass("clone"),o=i.attr("id");i.find(".video."+o).length||(c?i.prepend('<div class="wrapper_video"><iframe id="player_'+r+'" class="video '+o+(p?" cover":"")+'" src="'+l+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen;"'+(w&&g?' data-video_proportion="'+w/g+'"':"")+"></iframe></div>"):v?i.prepend('<div class="wrapper_video"><iframe id="player_'+r+'" class="video '+o+(p?" cover":"")+'" src="'+l+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen;"'+(w&&g?' data-video_proportion="'+w/g+'"':"")+"></iframe></div>"):u?(l=l+"&playerid="+r,i.prepend('<div class="wrapper_video"><iframe id="player_'+r+'" class="video '+o+(p?" cover":"")+'" src="'+l+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="autoplay; encrypted-media; gyroscope; fullscreen;"'+(w&&g?' data-video_proportion="'+w/g+'"':"")+"></iframe></div>")):f&&i.prepend('<div class="wrapper_video"><video autobuffer playsinline webkit-playsinline autoplay id="player_'+r+'" class="video '+o+(p?" cover":"")+'"'+(s?" loop ":"")+(d||t?" muted ":"")+'><source src="'+l+'" type=\'video/mp4; codecs="avc1.42E01E, mp4a.40.2"\' /><p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web browser that supports HTML5 video</p></iframe></div>')),void 0!==players&&players&&(players[r]={id:"player_"+r,mute:d||t,loop:s,cover:p,videoPlayer:y,slideIndex:n,clone:t,playing:!1,videoWidth:w,videoHeight:g,videoProportion:!(!w||!g)&&w/g},c?window[players[r].id]=new YT.Player(players[r].id,{events:{onReady:onYoutubePlayerReady,onStateChange:onYoutubePlayerStateChange}}):v?(window[players[r].id]=new Vimeo.Player(document.getElementById(players[r].id),{autopause:!1,byline:!1,loop:!1,title:!1}),window[players[r].id].on("loaded",onVimeoPlayerReady),window[players[r].id].on("play",onVimeoPlayerStateChange),window[players[r].id].on("pause",onVimeoPlayerStateChange),window[players[r].id].on("ended",onVimeoPlayerStateChange)):u?document.getElementById(players[r].id).onload=function(e){var a=this.id.replace("player_","");players[a].contentWindow=this.contentWindow,onRutubePlayerReady(a)}:f&&(document.getElementById(players[r].id).addEventListener("loadeddata",onHtml5PlayerReady),document.getElementById(players[r].id).addEventListener("play",onHtml5PlayerStateChange),document.getElementById(players[r].id).addEventListener("pause",onHtml5PlayerStateChange),document.getElementById(players[r].id).addEventListener("ended",onHtml5PlayerStateChange)))})}if(f)t();else{var o="",m="";if(void 0===window.YoutubePlayerScriptLoaded&&(window.YoutubePlayerScriptLoaded=!1),void 0===window.VimeoPlayerScriptLoaded&&(window.VimeoPlayerScriptLoaded=!1),void 0===window.RutubePlayerListnersAdded&&(window.RutubePlayerListnersAdded=!1),c){if(o="YT",m="Player",!window.YoutubePlayerScriptLoaded){(b=document.createElement("script")).src="https://www.youtube.com/iframe_api";var h=document.getElementsByTagName("script")[0];h.parentNode.insertBefore(b,h),window.YoutubePlayerScriptLoaded=!0}}else if(v){var b;if(o="Vimeo",!window.VimeoPlayerScriptLoaded)(b=document.createElement("script")).src="https://player.vimeo.com/api/player.js",(document.head||document.documentElement).appendChild(b),window.VimeoPlayerScriptLoaded=!0}else u&&(window.RutubePlayerListnersAdded||window.addEventListener("message",function(e){if(-1!==e.origin.indexOf("rutube.ru")){var a=JSON.parse(e.data);if("object"==typeof a&&a&&void 0!==a.type&&a.type){var i=!1;for(var r in players)if(void 0!==players[r].contentWindow&&players[r].contentWindow==e.source){i=r;break}if(i)switch(a.type){case"player:changeState":onRutubePlayerStateChange(i,a.data.state);break;case"player:currentTime":onRutubePlayerCurrentTime(i,a.data.time)}}}}));if(o.length)if("object"==typeof window[o])(!m.length||m.length&&"function"==typeof window[o][m])&&t();else var _=setInterval(function(){"object"==typeof window[o]&&(!m.length||m.length&&"function"==typeof window[o][m])&&(clearInterval(_),t())},50);else t()}}else if(void 0!==players&&players)for(var P in players)players[P].clone||"object"==typeof window[players[P].id]&&(players[P].playing?"YOUTUBE"===players[P].videoPlayer?window[players[P].id].pauseVideo():"VIMEO"===players[P].videoPlayer?window[players[P].id].pause():"RUTUBE"===players[P].videoPlayer?document.getElementById(players[P].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"):"HTML5"===players[P].videoPlayer&&document.getElementById(players[P].id).pause():players[P].slideIndex==n&&("YOUTUBE"===players[P].videoPlayer?window[players[P].id].playVideo():"VIMEO"===players[P].videoPlayer?window[players[P].id].play():"RUTUBE"===players[P].videoPlayer?document.getElementById(players[P].id).contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*"):"HTML5"===players[P].videoPlayer&&document.getElementById(players[P].id).play()))}}var CoverPlayer=function(){$(".top_slider_wrapp .video.cover").each(function(){var e=$(this).closest(".top_slider_wrapp.view_2");if(e.length&&window.matchMedia("(max-width:767px)").matches)var a=e.find("table .main_info");else a=$(this).closest(".box");var i=a.height(),r=a.width(),t=$(this).attr("data-video_proportion");void 0===t&&(t=16/9);var o=r,n=r/t;n<i&&(o=i*t,n=i),$(this).width(o).height(n).css({"margin-top":"-"+(n-i)/2+"px","margin-left":"-"+(o-r)/2+"px"})})};function onYoutubePlayerReady(e){var a=e.target.f.id.replace("player_","");if(a){var i=players[a].mute,r=players[a].cover,t=players[a].clone,o=$("#player_"+a).closest(".box");if((i||t)&&window[players[a].id].mute(),r){if(!players[a].videoProportion){var n=e.target.getVideoEmbedCode();if(n.length){var l=n.match(/width="(\d*)"[^>]*height="(\d*)"/);if(null!==l){var d=l[1],s=l[2];players[a].videoWidth=d,players[a].videoHeight=s,players[a].videoProportion=d/s,o.find(".video").attr("data-video_proportion",players[a].videoProportion)}}}CoverPlayer()}t?setTimeout(function(){e.target.pauseVideo()},100):(pauseMainBanner(),e.target.playVideo()),o.addClass("started")}}function onYoutubePlayerStateChange(e){var a=e.target.f.id.replace("player_","");if(a){var i=players[a].clone,r=players[a].loop,t=players[a].slideIndex;if(!i)if(e.data===YT.PlayerState.PLAYING)players[a].playing=!0,$("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),pauseMainBanner(),e.target.playVideo();else if(e.data===YT.PlayerState.PAUSED){players[a].playing=!1;var o=Math.floor(10*window[players[a].id].getCurrentTime())/10;for(var n in $("#player_"+a).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),window[players[a].id].seekTo(o,!0),players)players[n].slideIndex==t&&players[n].clone&&"getCurrentTime"in window[players[n].id]&&(window[players[n].id].pauseVideo(),window[players[n].id].seekTo(o,!0))}else e.data===YT.PlayerState.ENDED?(players[a].playing=!1,r?e.target.playVideo():playMainBanner()):e.data===YT.PlayerState.UNSTARTED&&(players[a].playing=!1,$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),e.target.playVideo())}}function onVimeoPlayerReady(e){var r=this.element.id.replace("player_","");if(r){var a=players[r].mute,i=players[r].cover,t=players[r].clone,o=$("#player_"+r).closest(".box");if((a||t)&&window[players[r].id].setVolume(0),i&&!players[r].videoProportion){var n=window[players[r].id].getVideoWidth(),l=window[players[r].id].getVideoHeight();n.then(function(e){var i=e;l.then(function(e){var a=e;players[r].videoWidth=i,players[r].videoHeight=a,players[r].videoProportion=i/a,o.find(".video").attr("data-video_proportion",players[r].videoProportion),CoverPlayer()})})}if(t)setTimeout(function(){window[players[r].id].pause()},100);else{pauseMainBanner();var d=window[players[r].id].play();void 0!==d&&d.catch(function(){setTimeout(function(){window[players[r].id].setVolume(0),window[players[r].id].play()},100)})}o.addClass("started")}}function onVimeoPlayerStateChange(e){var a=this.element.id.replace("player_","");if(a){players[a].cover;var i=players[a].clone,r=players[a].loop,t=players[a].slideIndex;i||window[players[a].id].getPaused().then(function(e){e?(players[a].playing=!1,$("#player_"+a).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),window[players[a].id].getCurrentTime().then(function(e){var i=Math.floor(10*e)/10;window[players[a].id].setCurrentTime(i).then(function(e){for(var a in players)players[a].slideIndex==t&&players[a].clone&&(window[players[a].id].pause(),window[players[a].id].setCurrentTime(i).then(function(e){}))})})):($("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),window[players[a].id].getEnded().then(function(e){e?(players[a].playing=!1,r?window[players[a].id].play():playMainBanner()):(players[a].playing=!0,pauseMainBanner())}))})}}function onRutubePlayerReady(e){if(e){var a=players[e].mute,i=players[e].cover,r=players[e].clone,t=document.getElementById(players[e].id),o=$("#player_"+e).closest(".box");(a||r)&&t.contentWindow.postMessage(JSON.stringify({type:"player:mute",data:{}}),"*"),i&&CoverPlayer(),r?setTimeout(function(){t.contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*")},100):(pauseMainBanner(),t.contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*")),o.addClass("started")}}function onRutubePlayerCurrentTime(e,a){e&&(players[e].time=a)}function onRutubePlayerStateChange(e,a){if(e){var i=players[e].clone,r=players[e].loop,t=players[e].slideIndex,o=document.getElementById(players[e].id);if(!i)if("playing"===a)$("#"+e).closest(".box").find(".wrapper_inner").addClass("loading"),$("#"+e).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),players[e].playing=!0,pauseMainBanner();else if("paused"===a){$("#"+e).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#"+e).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),players[e].playing=!1;var n=Math.floor(10*players[e].time)/10;for(var l in o.contentWindow.postMessage(JSON.stringify({type:"player:setCurrentTime",data:{time:n}}),"*"),players)players[l].slideIndex==t&&players[l].clone&&(document.getElementById(players[l].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"),document.getElementById(players[l].id).contentWindow.postMessage(JSON.stringify({type:"player:setCurrentTime",data:{time:n}}),"*"))}else"stopped"===a&&($("#"+e).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#"+e).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),players[e].playing=!1,r?o.contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*"):playMainBanner())}}function onHtml5PlayerReady(e){var a=e.target.id.replace("player_","");if(a){var i=players[a].mute,r=players[a].cover,t=players[a].clone,o=$("#player_"+a).closest(".box");if((i||t)&&$("#"+players[a].id).prop("muted",!0),r){if(!players[a].videoProportion){var n=o.find(".video")[0].videoWidth,l=o.find(".video")[0].videoHeight;players[a].videoWidth=n,players[a].videoHeight=l,players[a].videoProportion=n/l,o.find(".video").attr("data-video_proportion",players[a].videoProportion)}CoverPlayer()}if(t)e.target.pause();else{pauseMainBanner();var d=e.target.play();void 0!==d&&d.catch(function(){setTimeout(function(){$("#"+players[a].id).prop("muted",!0),e.target.play()},100)})}o.addClass("started")}}function onHtml5PlayerStateChange(e){var a=e.target.id.replace("player_","");if(a){players[a].cover;var i=players[a].clone,r=players[a].loop,t=players[a].slideIndex;if(!i)if(e.target.paused){players[a].playing=!1,$("#player_"+a).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading");var o=Math.floor(10*e.target.currentTime)/10;for(var n in e.target.currentTime=o,players)players[n].slideIndex==t&&players[n].clone&&(document.getElementById(players[n].id).pause(),document.getElementById(players[n].id).currentTime=o)}else e.target.ended?(players[a].playing=!1,r?($("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),e.target.play()):playMainBanner()):(players[a].playing=!0,$("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),pauseMainBanner())}}waitYTPlayer=function(e,a){"undefined"!=typeof YT&&YT&&YT.Player?"function"==typeof a&&a():setTimeout(function(){waitYTPlayer(e,a)},e)},$(document).on("click","video.video",function(e){var a=e.target.id.replace("player_","");a&&(players[a].playing?e.target.pause():e.target.play())}),$(document).on("click",".top_slider_wrapp .box .btn-video",function(e){e.stopPropagation(),$(this).hasClass("loading")?($(this).removeClass("loading"),$(this).closest(".wrapper_inner").removeClass("loading")):($(this).addClass("loading"),$(this).closest(".wrapper_inner").addClass("loading")),startMainBannerSlideVideo($(this).closest(".box"))}),$(document).on("click",".top_slider_wrapp .box .wrapper_inner",function(e){var a=$(this).closest(".box").hasClass("wvideo"),i=$(this).closest(".box").hasClass("wurl");if($(e.target).hasClass("btn"))a&&$(e.target).hasClass("btn-video")&&(e.stopPropagation(),$(this).find(".btn-video").trigger("click"));else if($(e.target).closest(".banner_buttons.with_actions").length)e.stopPropagation();else if(i){var r=$(this).closest(".box").find(".target").attr("href");if(r.length){var t=$(this).closest(".box").find(".target").attr("target");void 0===t||"_self"===t?location.href=r:window.open(r)}}else a&&(e.stopPropagation(),$(this).find(".btn-video").trigger("click"))}),getRandomInt=function(e,a){return Math.floor(Math.random()*(a-e))+e};var ignoreResize=[];BX.addCustomEvent("onWindowResize",function(e){try{CoverPlayer()}catch(e){}finally{ignoreResize.pop()}}),BX.addCustomEvent("onSlideEnd",function(e){try{if(ignoreResize.push(!0),e)e.slider&&setTimeout(function(){$(".banners-big.front .btn-video, .banners-big.front .box").removeClass("loading")},300)}catch(e){}finally{ignoreResize.pop()}}),BX.addCustomEvent("onSlide",function(e){try{if(ignoreResize.push(!0),e){var a=e.slider;if(a){var i=a.find(".box.flex-active-slide"),r=i.attr("data-slide_index");if(void 0!==r&&r.length){var t=a.data("slidesIndexesWithVideo");if(void 0===t&&(t=[]),-1!=t.indexOf(r)?a.addClass("video_visible"):a.removeClass("video_visible"),setTimeout(function(){CoverPlayer()},200),void 0!==players&&players)for(var o in players)players[o].playing&&!players[o].clone&&players[o].slideIndex!=r&&"object"==typeof window[players[o].id]&&("YOUTUBE"===players[o].videoPlayer?window[players[o].id].pauseVideo():"VIMEO"===players[o].videoPlayer?window[players[o].id].pause():"RUTUBE"===players[o].videoPlayer?document.getElementById(players[o].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"):"HTML5"===players[o].videoPlayer&&document.getElementById(players[o].id).pause());1==i.attr("data-video_autoplay")&&startMainBannerSlideVideo(i)}if(i.find("video").length&&!i.find(".btn-video").length){var n=i.find("video").attr("id");document.getElementById(n).play()}}}}catch(e){}finally{ignoreResize.pop()}});